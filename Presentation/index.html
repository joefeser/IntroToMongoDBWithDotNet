<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Using MongoDB in .NET</title>

		<meta name="description" content="In this talk we will go over what is involved in setting up MongoDB on Windows and what is involved in working with it in C#. We will discuss: how to serialize / deserialize objects, how to query the data, and how to configure databases and containers ("tables"). 

Joe will demonstrate what an e-commerce ordering system would look like in MS Sql Server and compare how it would look in MongoDB, including the sample code.  Joe will demonstrate how to create object structures for quick get and set operations. He will wrap up by discussing the challenges of migrating to MongoDB from Sql server including searching and indexing.  ">
		<meta name="author" content="Joe Feser">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/default.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- // Any section element inside of this container is displayed as a slide -->
<div class="slides">
				<section data-id="1a717503f1508e921c50e774f5f9b310"><h1>Using Mongodb in .NET</h1>
<div>by</div>
<div>Joe Feser</div>
<div>of</div>
<div>Logical Advantage</div>
<div>@joefeser Twitter</div>
<div>joefeser github</div>
<div><br></div>
    </section><section data-id="1b2dd2b010f9cf146e1073b389da8ebc"><section data-id="89f92034b0244eb14207f25fc972576b"><h2>What is it?</h2>
<div style="text-align: left; ">MongoDB is an open-source NoSQL database used by companies of all sizes, across all industries and for a wide variety of applications. It is an agile database that allows schemas to change quickly as applications evolve, while still providing the functionality developers expect from traditional databases, such as secondary indexes, a full query language and strict consistency.<br>
</div>
<div style="text-align: left; "><br></div>
<div style="text-align: left; "><br></div>
<div style="text-align: left; ">
<font style="font-size: 18px;">http://www.mongodb.com/mongodb-overview</font><br>
</div>
    </section><section data-id="3e514c10722f264af7ea6e6d03941097"><h2>Features</h2>
<div>
<div><br></div>
<div><ul>
<li>
<span style="text-align: center;">JSON Data Model with Dynamic Schemas</span><br>
</li>
<li>
<span style="text-align: center;">Auto-Sharding for Horizontal Scalability</span><br>
</li>
<li>
<span style="text-align: center;">Built-In Replication for High Availability</span><br>
</li>
<li>
<span style="text-align: center;">Rich Secondary Indexes, including geospatial and TTL indexes</span><br>
</li>
<li>
<span style="text-align: center;">Text Search</span><br>
</li>
<li>
<span style="text-align: center;">Aggregation Framework &amp; Native MapReduce</span><br>
</li>
<li>
<span style="text-align: center;">Hadoop Integration</span><br>
</li>
<li>
<span style="text-align: center;">Drivers: 10 MongoDB-Supported Drivers; 40 Community-Supported Drivers<br></span><span style="font-style: normal; font-variant: normal;"><font style="font-size: 18px;">http://www.mongodb.com/mongodb-overview</font></span><br>
</li>
</ul></div>
</div></section><section data-id="18c162ce9aa30f5bfee04927972726b8"><h2>Drivers in many languages</h2>
<div>
<div><font style="font-size: 32px;">JavaScript</font></div>
<div><font style="font-size: 32px;">Python</font></div>
<div><font style="font-size: 32px;">Ruby</font></div>
<div><font style="font-size: 32px;">PHP</font></div>
<div><font style="font-size: 32px;">Perl</font></div>
<div><font style="font-size: 32px;">Java</font></div>
<div><font style="font-size: 32px;">Scala</font></div>
<div><font style="font-size: 32px;">C#</font></div>
<div><font style="font-size: 32px;">C</font></div>
<div><font style="font-size: 32px;">C++</font></div>
<div><font style="font-size: 32px;">Haskell</font></div>
<div><font style="font-size: 32px;">Erlang</font></div>
</div></section></section><section data-id="50af7a7c350720e91ee7ebe45e83a1d4"><section data-id="43095b978ce5bcc6f630376b35c5391d"><h2>Use Cases</h2>
<div><br></div>
<div>
<div style="text-align: left; ">MongoDB is a general purpose database suitable for most applications and use cases.</div>
<div style="text-align: left; "><br></div>
</div>
<div style="text-align: left; ">
<font style="font-size: 18px;">http://www.mongodb.com/use-cases</font><br>
</div>
    </section><section data-id="1e09e1ea83fee7fd412576ee4177627f"><h2>Use Cases</h2>
<div><div><ul>
<li style="text-align: left; ">
<span style="text-align: center;">Big Data</span><br>
</li>
<li style="text-align: left; ">
<span style="text-align: center;">Content Management and Delivery</span><br>
</li>
<li style="text-align: left; ">
<span style="text-align: center;">Customer Data Management</span><br>
</li>
<li style="text-align: left; ">
<span style="text-align: center;">Data Hub</span><br>
</li>
<li style="text-align: left; ">
<span style="text-align: center;">Database-as-a-Service</span><br>
</li>
<li style="text-align: left; ">
<span style="text-align: center;">Internet of Things</span><br>
</li>
<li style="text-align: left; ">
<span style="text-align: center;">Mobile Apps</span><br>
</li>
<li style="text-align: left; ">
<span style="text-align: center;">Product and Asset Catalogs</span><br>
</li>
<li style="text-align: left; ">
<span style="text-align: center;">Security and Fraud Apps</span><br>
</li>
<li style="text-align: left; ">
<span style="text-align: center;">Social and Collaboration Apps</span><br>
</li>
</ul></div></div>
<div style="text-align: left; "><font style="font-size: 18px;"><br></font></div>
<div style="text-align: left; ">
<font style="font-size: 18px;">http://www.mongodb.com/use-cases</font><br>
</div></section></section><section data-id="b29348c8c0cf2609d0e3c47a45effbd5"><section data-id="8d734e9652aeb08cb7fb2d9a2990c9f9"><h2>Setting up mongodb</h2>
    
</section><section data-id="5053f6104b97954f7390094bb06e2578"><h2>Download the latest build</h2>
<div><br></div>
<div>
<img src="../images/download.png"><br>
</div>
<div><br></div>
<div>http://www.mongodb.org/downloads<br>
</div>
<div><br></div></section><section data-id="06f9a665a8f83296f76a22917239cdf9"><h2>Unzip the files</h2>
<div><br></div>
<div><img src="../images/installfolder.png"></div>
<div>I use c:\mongodb\bin<br>
</div></section><section data-id="56991727b87b6344cbf179d93547c1a5"><h2>Create a folder for the data</h2>
<div>
<img src="../images/datadbfolder.png"><br>
</div>
<div>
<span>The default is c:\data\db</span><br>
</div>
<div><div>This is the default folder on the same drive as mongod.exe. You can also pass a different folder as a command line option (dbpath).</div></div></section><section data-id="a127628c75b6d68b2c5a027b1e309248"><h2>Start MongoD</h2>
<div><br></div>
<div>
<img src="../images/startmongodb.png"><br>
</div>
<div><br></div>
<div>From the c:\mongodb\bin folder</div></section><section data-id="d9c4595708ed0e1505913058ce0b0fad"><h2>More Information</h2>
<div>http://docs.mongodb.org/manual/tutorial/install-mongodb-on-windows/<br>
</div></section></section><section data-id="7d6862e4129fd954741c6ca3195354e3"><section data-id="112b830ab52fb32341b86efaa0454726"><h2>Terms vs Sql Server</h2>
<div>
    <table><tbody>
<tr>
<td>
<font style="font-size: 18px;">SQL Terms/Concepts</font>
</td>
            <td>
<font style="font-size: 18px;">MongoDB Terms/Concepts</font>
</td>
        </tr>
<tr>
<td>
<font style="font-size: 18px;">database</font>
</td>
            <td>
<font style="font-size: 18px;">database</font>
</td>
        </tr>
<tr>
<td>
<font style="font-size: 18px;">table</font>
</td>
            <td>
<font style="font-size: 18px;">collection</font>
</td>
        </tr>
<tr>
<td>
<font style="font-size: 18px;">row</font>
</td>
            <td>
<font style="font-size: 18px;">document or BSON document</font>
</td>
        </tr>
<tr>
<td>
<font style="font-size: 18px;">column</font>
</td>
            <td>
<font style="font-size: 18px;">field</font>
</td>
        </tr>
<tr>
<td>
<font style="font-size: 18px;">index</font>
</td>
            <td>
<font style="font-size: 18px;">index</font>
</td>
        </tr>
</tbody></table>
<br>
</div>
<div style="text-align: left; ">
<font style="font-size: 18px;">http://docs.mongodb.org/manual/reference/sql-comparison/</font><br>
</div>
    

</section><section data-id="d347038477b5e3452ad9a6efee6d0060"><h2>Terms vs SQL Server</h2>
<div>
    <table style="text-align: left; "><tbody>
<tr>
<td>
<font style="font-size: 18px;">SQL Terms/Concepts</font>
</td>
            <td>
<font style="font-size: 18px;">MongoDB Terms/Concepts</font>
</td>
        </tr>
<tr>
<td>
<font style="font-size: 18px;">table joins</font>
</td>
            <td>
<font style="font-size: 18px;">embedded documents and linking</font>
</td>
        </tr>
<tr>
<td>
<font style="font-size: 18px;">primary key</font>
</td>
            <td>
<font style="font-size: 18px;">primary key</font>
</td>
        </tr>
<tr>
<td>
<font style="font-size: 18px;">Specify any unique column or column combination as primary key.</font>
</td>
            <td>
<font style="font-size: 18px;">In MongoDB, the primary key is automatically set to the _id field.</font>
</td>
        </tr>
<tr>
<td>
<font style="font-size: 18px;">aggregation (e.g. group by)</font>
</td>
            <td>
<font style="font-size: 18px;">aggregation pipeline</font>
</td>
        </tr>
</tbody></table>
<p style="text-align: left; "><font style="font-size: 18px;"><br></font></p>
<p style="text-align: left; "><font style="font-size: 18px;">http://docs.mongodb.org/manual/reference/sql-comparison/</font></p>
</div>
</section></section><section data-id="b10ccb22c0c6c97ca16517e950c4f4d8"><section data-id="a931f754abfafbd1ce344d60287bbfa0"><h2>Data types</h2>
<div><div><ul>
<li>
<span style="text-align: center;">Object id</span><br>
</li>
<li>
<span style="text-align: center;">Integer 32 / 64 bit</span><br>
</li>
<li>
<span style="text-align: center;">Double</span><br>
</li>
<li>
<span style="text-align: center;">String</span><br>
</li>
<li>
<span style="text-align: center;">Object</span><br>
</li>
<li>
<span style="text-align: center;">Array</span><br>
</li>
<li>
<span style="text-align: center;">Binary data</span><br>
</li>
<li>
<span style="text-align: center;">Boolean</span><br>
</li>
<li>
<span style="text-align: center;">Date</span><br>
</li>
<li>
<span style="text-align: center;">Null</span><br>
</li>
</ul></div></div></section><section data-id="79f6f3c86736b670f6d5c9fc9e05fcf5"><h2>BSON Data types</h2>
<div>
    <div style="text-align: center;font-size: 22px;">
        <ul>
<li>
                Type
            </li>
            <li>
                Double
            </li>
            <li>
                String
            </li>
            <li>
                Object
            </li>
            <li>
                Array
            </li>
            <li>
                Binary data
            </li>
            <li>
                Object id
            </li>
            <li>
                Boolean
            </li>
            <li>
                Date
            </li>
            <li>
                Null
            </li>
            <li>
                Regular Expression
            </li>
            <li>
                JavaScript
            </li>
            <li>
                Symbol
            </li>
            <li>
                JavaScript (with scope)
            </li>
            <li>
                32-bit integer
            </li>
            <li>
                Timestamp
            </li>
            <li>
                64-bit integer
            </li>
            <li>
                Min key
            </li>
            <li>
                Max key
            </li>
        </ul>
<div style="text-align: left;font-size: 18px;">
<br>
    http://docs.mongodb.org/manual/reference/bson-types/
</div>
    </div>
</div>






</section></section><section data-id="b7524c1533f72eda0a59a6a80f0e0520"><section data-id="7e3e2edf5b4e4ed357adb6c07299239c"><h2>How to connect to MongoDB from .Net</h2>
<div><div><ul>
<li>
<span style="text-align: center;">Configure a connection</span><br>
</li>
<li>
<span style="text-align: center;">Create a MongoClient object</span><br>
</li>
<li>
<span style="text-align: center;">Create a MongoServer</span><br>
</li>
<li>
<span style="text-align: center;">Get access to a MongoDB database</span><br>
</li>
<li>
<span style="text-align: center;">Consider using static properties</span><br>
</li>
</ul></div></div></section><section data-id="5e8c198ca667a7dc66ffc5c848490035"><h2>How to connect to MongoDB from .Net</h2>
<div style="text-align: left; "><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:blue;">public</span> <span style="color:blue;">static</span> <span style="color:blue;">string</span> <span style="color:gray;">connectionString</span> <span style="color:red;">=</span> <span style="color:#a31515;">"mongodb://localhost"</span>;
<span style="color:blue;">public</span> <span style="color:blue;">static</span> <span style="color:#2b91af;">MongoClient</span> <span style="color:gray;">Client</span> <span style="color:red;">=</span> <span style="color:blue;">new</span> <span style="color:#2b91af;">MongoClient</span>(<span style="color:gray;">connectionString</span>);
<span style="color:blue;">public</span> <span style="color:blue;">static</span> <span style="color:#2b91af;">MongoServer</span> <span style="color:gray;">Server</span> <span style="color:red;">=</span> <span style="color:gray;">Client</span><span style="color:red;">.</span><span style="color:gray;">GetServer</span>();
<span style="color:blue;">public</span> <span style="color:blue;">static</span> <span style="color:#2b91af;">MongoDatabase</span> <span style="color:gray;">MainDatabase</span> <span style="color:red;">=</span> <span style="color:gray;">Server</span><span style="color:red;">.</span><span style="color:gray;">GetDatabase</span>(<span style="color:#a31515;">"commerce"</span>);</pre></div></section></section><section data-id="ea245a15db1687e92256d7df42624fa7"><h2>How do you access MongoDB collections</h2>
<div style="text-align: left; ">The MongoDatabase object has a method on it called GetCollection&lt;T&gt; allowing you a strongly types object reference.</div>
<div style="text-align: left; "><br></div>
<div style="text-align: left; ">You are not limited to storing one type of object in a collection, but I do to keep from making mistakes, not having _id collisions, and to keep sane.</div>
<div style="text-align: left; "><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:blue;">public</span> <span style="color:blue;">static</span> <span style="color:#2b91af;">MongoCollection</span><span style="color:red;">&lt;</span><span style="color:#2b91af;">MongoProduct</span><span style="color:red;">&gt;</span> <span style="color:gray;">ProductCollection</span> 
    <span style="color:red;">=</span> <span style="color:#2b91af;">Mongo</span><span style="color:red;">.</span><span style="color:gray;">MainDatabase</span><span style="color:red;">.</span><span style="color:gray;">GetCollection</span><span style="color:red;">&lt;</span><span style="color:#2b91af;">MongoProduct</span><span style="color:red;">&gt;</span>(<span style="color:#a31515;">"product"</span>);
</pre></div></section><section data-id="072070b6537101a7cc9503c1480ba8da"><section data-id="4d7d55e43b76f7560872688efd8d11ec"><h2>How to set up your classes for serialization</h2>
<div>By default, all of your properties will be serialized, as long as they are not read only (only a get)</div>
<div><br></div>
<div>There are many ways to set up your objects for serialization. This gives you total control over how your objects are serialized and deserialized</div>
<div><br></div>
<div>You can use POCO objects with no markup using the BsonClassMap</div>
    </section><section data-id="f98da463fc849272031408a7054928fe"><h2>How to set up your classes for serialization</h2>
<div>Custom Attributes</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;">[<span style="color:#2b91af;">BsonIgnoreIfNull</span>]
[<span style="color:#2b91af;">BsonElement</span>(<span style="color:#a31515;">"esrb"</span>)]
<span style="color:blue;">public</span> <span style="color:blue;">string</span> <span style="color:gray;">ESRBAgeRating</span> {
    <span style="color:blue;">get</span>;
    <span style="color:blue;">set</span>;
}
 
[<span style="color:#2b91af;">BsonElement</span>(<span style="color:#a31515;">"format"</span>)]
<span style="color:blue;">public</span> <span style="color:blue;">string</span> <span style="color:gray;">Format</span> {
    <span style="color:blue;">get</span>;
    <span style="color:blue;">set</span>;
}
</pre></div></section><section data-id="0a561faa30a98375f57cd6f7f97c76c1"><h2>How to set up your classes for serialization</h2>
<div>BsonClassMap</div>
<div>This will be a very familiar pattern for those that are used to AutoMapper</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:#2b91af;">BsonClassMap</span><span style="color:red;">.</span><span style="color:gray;">RegisterClassMap</span><span style="color:red;">&lt;</span><span style="color:#2b91af;">MongoProduct</span><span style="color:red;">&gt;</span>(<span style="color:gray;">cm</span> <span style="color:red;">=&gt;</span> {
    <span style="color:gray;">cm</span><span style="color:red;">.</span><span style="color:gray;">AutoMap</span>();
    <span style="color:gray;">cm</span><span style="color:red;">.</span><span style="color:gray;">SetIgnoreExtraElements</span>(<span style="color:blue;">true</span>);
    <span style="color:gray;">cm</span><span style="color:red;">.</span><span style="color:gray;">UnmapProperty</span>(<span style="color:gray;">c</span> <span style="color:red;">=&gt;</span> <span style="color:gray;">c</span><span style="color:red;">.</span><span style="color:gray;">BuyItNowPrice</span>);
    <span style="color:gray;">cm</span><span style="color:red;">.</span><span style="color:gray;">GetMemberMap</span>(<span style="color:gray;">c</span> <span style="color:red;">=&gt;</span> <span style="color:gray;">c</span><span style="color:red;">.</span><span style="color:gray;">Format</span>)<span style="color:red;">.</span><span style="color:gray;">SetIgnoreIfNull</span>(<span style="color:blue;">true</span>);
    <span style="color:gray;">cm</span><span style="color:red;">.</span><span style="color:gray;">GetMemberMap</span>(<span style="color:gray;">c</span> <span style="color:red;">=&gt;</span> <span style="color:gray;">c</span><span style="color:red;">.</span><span style="color:gray;">Genre</span>)<span style="color:red;">.</span><span style="color:gray;">SetIgnoreIfNull</span>(<span style="color:blue;">true</span>);
});</pre></div></section><section data-id="7225273a9e6627ccd6b201bcca4442c9"><h2>How to set up your classes for serialization</h2>
<div>Decimal types are not supported! </div>
<div><br></div>
<div>How do I save them so they are not saved as strings?</div></section><section data-id="6a11b8910baecb2ec85b2cc84c8a954a"><h2>How to set up your classes for serialization</h2>
<div>Your best bet is to convert the value to an integer or long data type.</div>
<div><br></div>
<div>Pick a common scale for all decimals in a type (or globally) so the user will not have to guess how to convert your value back</div></section><section data-id="6a03dcc44a38ee439cb6a2c4c23e93cb"><h2>How to set up your classes for serialization</h2>
<div>Using another property in your class to serialize the object. </div>
<div>Not as clean but no mapper is needed. </div>
<div>This is problematic for query operations in c#.</div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;">[<span style="color:#2b91af;">BsonElement</span>(<span style="color:#a31515;">"listPrice"</span>)]
<span style="color:blue;">public</span> <span style="color:blue;">int</span> <span style="color:gray;">ListPriceInteger</span> {
    <span style="color:blue;">get</span> {
        <span style="color:blue;">return</span> (<span style="color:blue;">int</span>)(<span style="color:gray;">ListPrice</span> <span style="color:red;">*</span> <span style="color:maroon;">10000</span>); <span style="color:green;">//4 dec places</span>
    }
    <span style="color:blue;">set</span> {
        <span style="color:gray;">ListPrice</span> <span style="color:red;">=</span> <span style="color:blue;">value</span> <span style="color:red;">/</span> <span style="color:maroon;">10000</span>;
    }
}
 
<span style="color:green;">//MSRP</span>
[<span style="color:#2b91af;">BsonIgnore</span>]
<span style="color:blue;">public</span> <span style="color:blue;">decimal</span> <span style="color:gray;">ListPrice</span> {
    <span style="color:blue;">get</span>;
    <span style="color:blue;">set</span>;
}
</pre></div></section><section data-id="d2d79312ab26cdbe2f46d94a2876a55d"><h2>How to set up your classes for serialization</h2>
<div>Create a serializer and use that in your BsonClassMap to write the value</div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:#2b91af;">BsonClassMap</span><span style="color:red;">.</span><span style="color:gray;">RegisterClassMap</span><span style="color:red;">&lt;</span><span style="color:#2b91af;">Dimension</span><span style="color:red;">&gt;</span>(<span style="color:gray;">cm</span> <span style="color:red;">=&gt;</span> {
    <span style="color:gray;">cm</span><span style="color:red;">.</span><span style="color:gray;">AutoMap</span>();
    <span style="color:gray;">cm</span><span style="color:red;">.</span><span style="color:gray;">GetMemberMap</span>(<span style="color:gray;">c</span> <span style="color:red;">=&gt;</span> <span style="color:gray;">c</span><span style="color:red;">.</span><span style="color:gray;">Height</span>)<span style="color:red;">.</span><span style="color:gray;">SetSerializer</span>(<span style="color:blue;">new</span> <span style="color:#2b91af;">DecimalSerializer</span>())
        <span style="color:red;">.</span><span style="color:gray;">SetElementName</span>(<span style="color:#a31515;">"height"</span>);
    <span style="color:gray;">cm</span><span style="color:red;">.</span><span style="color:gray;">GetMemberMap</span>(<span style="color:gray;">c</span> <span style="color:red;">=&gt;</span> <span style="color:gray;">c</span><span style="color:red;">.</span><span style="color:gray;">Length</span>)<span style="color:red;">.</span><span style="color:gray;">SetSerializer</span>(<span style="color:blue;">new</span> <span style="color:#2b91af;">DecimalSerializer</span>())
        <span style="color:red;">.</span><span style="color:gray;">SetElementName</span>(<span style="color:#a31515;">"length"</span>);
    <span style="color:gray;">cm</span><span style="color:red;">.</span><span style="color:gray;">GetMemberMap</span>(<span style="color:gray;">c</span> <span style="color:red;">=&gt;</span> <span style="color:gray;">c</span><span style="color:red;">.</span><span style="color:gray;">Weight</span>)<span style="color:red;">.</span><span style="color:gray;">SetSerializer</span>(<span style="color:blue;">new</span> <span style="color:#2b91af;">DecimalSerializer</span>())
        <span style="color:red;">.</span><span style="color:gray;">SetElementName</span>(<span style="color:#a31515;">"weight"</span>);
    <span style="color:gray;">cm</span><span style="color:red;">.</span><span style="color:gray;">GetMemberMap</span>(<span style="color:gray;">c</span> <span style="color:red;">=&gt;</span> <span style="color:gray;">c</span><span style="color:red;">.</span><span style="color:gray;">Width</span>)<span style="color:red;">.</span><span style="color:gray;">SetSerializer</span>(<span style="color:blue;">new</span> <span style="color:#2b91af;">DecimalSerializer</span>())
        <span style="color:red;">.</span><span style="color:gray;">SetElementName</span>(<span style="color:#a31515;">"width"</span>);
});</pre></div></section><section data-id="f8741a204f4ff8bb7d999fe452800964"><h2>How to set up your classes for serialization</h2>
<div>This is the original Dimension class. It is a POCO. All operations are performed in the BsonClassMap</div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:blue;">public</span> <span style="color:blue;">class</span> <span style="color:#2b91af;">Dimension</span> {
 
    <span style="color:blue;">public</span> <span style="color:blue;">decimal</span> <span style="color:gray;">Length</span> {
        <span style="color:blue;">get</span>; <span style="color:blue;">set</span>;
    }
 
    <span style="color:blue;">public</span> <span style="color:blue;">decimal</span> <span style="color:gray;">Height</span> {
        <span style="color:blue;">get</span>; <span style="color:blue;">set</span>;
    }
 
    <span style="color:blue;">public</span> <span style="color:blue;">decimal</span> <span style="color:gray;">Width</span> {
        <span style="color:blue;">get</span>; <span style="color:blue;">set</span>;
    }
 
    <span style="color:blue;">public</span> <span style="color:blue;">decimal</span> <span style="color:gray;">Weight</span> {
        <span style="color:blue;">get</span>; <span style="color:blue;">set</span>;
    }
}
</pre></div></section><section data-id="89148cc86dbcca304858cbc6a4f8c5f1"><h2>What does this look like in MongoDB?</h2>
<div>
<div>"dimensions" : {</div>
<div>    "length" : NumberLong(100400),</div>
<div>    "height" : NumberLong(5000),</div>
<div>    "width" : NumberLong(90100),</div>
<div>    "weight" : NumberLong(14100)</div>
<div>  }</div>
</div></section><section data-id="99766a875e7ca2b51037ddca1e3bb296"><h2>More information</h2>
<div style="text-align: left; "><ul>
<li>
<span>http://docs.mongodb.org/ecosystem/tutorial/serialize-documents-with-the-csharp-driver/</span><br>
</li>
<li>
<span>http://docs.mongodb.org/ecosystem/tutorial/use-csharp-driver/</span><br>
</li>
</ul></div></section></section><section data-id="e299deb4cbbb0653689e96f916a73262"><section data-id="b72f5ba2ac5303f0752d5f74403b4d57"><h2>Retrieving data</h2>
<div>Retrieving one record</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:blue;">var</span> <span style="color:gray;">query</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Query</span><span style="color:red;">&lt;</span><span style="color:#2b91af;">MongoProduct</span><span style="color:red;">&gt;</span>
    <span style="color:red;">.</span><span style="color:gray;">Where</span>(<span style="color:gray;">item</span> <span style="color:red;">=&gt;</span> <span style="color:gray;">item</span><span style="color:red;">.</span><span style="color:gray;">ASIN</span> <span style="color:red;">==</span> <span style="color:gray;">asinName</span>);
 
<span style="color:blue;">var</span> <span style="color:gray;">asin</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductCollection</span><span style="color:red;">.</span><span style="color:gray;">FindOne</span>(<span style="color:gray;">query</span>);
</pre></div></section><section data-id="38f5e2fd1010fbbff83145d61716b89d"><h2>Retrieving data</h2>
<div>Retrieving all items that are less than .1 lbs</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:blue;">var</span> <span style="color:gray;">query</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Query</span><span style="color:red;">&lt;</span><span style="color:#2b91af;">MongoProduct</span><span style="color:red;">&gt;</span>
    <span style="color:red;">.</span><span style="color:gray;">Where</span>(<span style="color:gray;">item</span> <span style="color:red;">=&gt;</span> <span style="color:gray;">item</span><span style="color:red;">.</span><span style="color:gray;">PackageDimensions</span><span style="color:red;">.</span><span style="color:gray;">Weight</span> <span style="color:red;">&lt;</span> <span style="color:maroon;">.1m</span>);
<span style="color:blue;">var</span> <span style="color:gray;">itemsVeryLight</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductCollection</span>
    <span style="color:red;">.</span><span style="color:gray;">FindAs</span><span style="color:red;">&lt;</span><span style="color:#2b91af;">MongoProduct</span><span style="color:red;">&gt;</span>(<span style="color:gray;">query</span>)<span style="color:red;">.</span><span style="color:gray;">ToList</span>();</pre></div>
    </section><section data-id="154938b2fce7b59b5d28406aa2feadf0"><h2>Retrieving data</h2>
<div>Projecting just the needed values to save processing and bandwidth.</div>
<div>The "Id" property will always be set</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:green;">//does work</span>
<span style="color:blue;">var</span> <span style="color:gray;">asin2</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductCollection</span><span style="color:red;">.</span><span style="color:gray;">Find</span>(<span style="color:gray;">query</span>)
    <span style="color:red;">.</span><span style="color:gray;">SetFields</span>(<span style="color:#2b91af;">Fields</span><span style="color:red;">.</span><span style="color:gray;">Include</span>(<span style="color:#a31515;">"listPrice"</span>, <span style="color:#a31515;">"title"</span>))<span style="color:red;">.</span><span style="color:gray;">FirstOrDefault</span>();
<span style="color:green;">//does not work</span>
<span style="color:blue;">var</span> <span style="color:gray;">asin2a</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductCollection</span><span style="color:red;">.</span><span style="color:gray;">Find</span>(<span style="color:gray;">query</span>)
    <span style="color:red;">.</span><span style="color:gray;">SetFields</span>(<span style="color:#2b91af;">Fields</span><span style="color:red;">.</span><span style="color:gray;">Include</span>(<span style="color:#a31515;">"ListPriceInteger"</span>, <span style="color:#a31515;">"Title"</span>))<span style="color:red;">.</span><span style="color:gray;">FirstOrDefault</span>();
 
<span style="color:green;">//must be the c# class properties.</span>
<span style="color:blue;">var</span> <span style="color:gray;">asin3</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductCollection</span><span style="color:red;">.</span><span style="color:gray;">Find</span>(<span style="color:gray;">query</span>)
    <span style="color:red;">.</span><span style="color:gray;">SetFields</span>(<span style="color:#2b91af;">Fields</span><span style="color:red;">&lt;</span><span style="color:#2b91af;">MongoProduct</span><span style="color:red;">&gt;.</span><span style="color:gray;">Include</span>(<span style="color:gray;">c</span> <span style="color:red;">=&gt;</span> <span style="color:gray;">c</span><span style="color:red;">.</span><span style="color:gray;">ListPriceInteger</span>, <span style="color:gray;">c</span> <span style="color:red;">=&gt;</span> <span style="color:gray;">c</span><span style="color:red;">.</span><span style="color:gray;">Title</span>))<span style="color:red;">.</span><span style="color:gray;">FirstOrDefault</span>();
</pre></div></section><section data-id="65886180983933497750ab8cf5272535"><h2>retrieving Data</h2>
<div>Find</div>
<div>FindOne</div></section></section><section data-id="6831eeb3aa5bcfdbb049050ca31d2436"><section data-id="7e4f0113aa635d081caf7584e700eaec"><h2>Saving data</h2>
<div>If you know that without a doubt that the object does not exist with the same id, you can use insert.</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:blue;">var</span> <span style="color:gray;">product</span> <span style="color:red;">=</span> <span style="color:blue;">new</span> <span style="color:#2b91af;">MongoProduct</span>() { };
 
<span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductCollection</span><span style="color:red;">.</span><span style="color:gray;">Insert</span><span style="color:red;">&lt;</span><span style="color:#2b91af;">MongoProduct</span><span style="color:red;">&gt;</span>(<span style="color:gray;">product</span>);
</pre></div>
    </section><section data-id="605c07209ca03bea977f70c1a1d5e8d3"><h2>Saving data</h2>
<div>If you are not sure if the id exists or you are performing an update, use the save method. This method will determine if an insert or update must happen.</div>
<div><br></div>
<div>If you want it to fail if the object already exists and you want it to be a new record, call insert. Save will override whatever is in the database</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:blue;">var</span> <span style="color:gray;">product</span> <span style="color:red;">=</span> <span style="color:blue;">new</span> <span style="color:#2b91af;">MongoProduct</span>() { };
 
<span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductCollection</span><span style="color:red;">.</span><span style="color:gray;">Save</span><span style="color:red;">&lt;</span><span style="color:#2b91af;">MongoProduct</span><span style="color:red;">&gt;</span>(<span style="color:gray;">product</span>);</pre></div></section><section data-id="5333bbf7380f0f236fc024853b94968a"><h2>Bulk Inserts</h2>
<div>If you have many objects to insert at once and they are all inserts, you can use the InsertBatch method.</div>
<div><br></div>
<div>It takes in an IEnumerable&lt;T&gt;.</div>
<div><br></div>
<div>It is very fast. For the sample data, 25,000 records were inserted in 1600 ms</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductCollection</span><span style="color:red;">.</span><span style="color:gray;">InsertBatch</span><span style="color:red;">&lt;</span><span style="color:#2b91af;">Product</span><span style="color:red;">&gt;</span>(<span style="color:gray;">list</span>);
</pre></div></section></section><section data-id="9deced3774f825a6cb82090d0b3a18e5"><section data-id="07d96e6f926051d270caa42f5e7a2c34"><h2>Atomic Updates</h2>
<div><ul>
<li>
<span style="text-align: center;">There is no concept of a pessimistic lock</span><br>
</li>
<li><span style="text-align: center;">Atomic updates are per document</span></li>
<li><span style="text-align: center;">Reading, modifying the document and saving is not atomic</span></li>
<li><span style="text-align: center;">Transactions do not exist</span></li>
</ul></div>
<div><br></div>
    </section><section data-id="f807d9fccf355a3bf8881fca7cbe58ea"><h2>Atomic Updates</h2>
<div style="text-align: left; ">findAndModify is the MongoDB method that performs atomic updates.</div>
<div style="text-align: left; "><span>You provide the method with:</span></div>
<div><ul>
<li>
<span style="text-align: center;">A Query (optional)</span><br>
</li>
<li>
<span style="text-align: center;">A Sort operator (optional)</span><br>
</li>
<li>
<span style="text-align: center;">If the document should be removed</span><br>
</li>
<li>
<span style="text-align: center;">The Update Statement</span><br>
</li>
<li>
<span style="text-align: center;">If you want the new document returned</span><br>
</li>
<li>
<span style="text-align: center;">The fields to return (optional)</span><br>
</li>
<li>
<span style="text-align: center;">If an upsert should be performed</span><br>
</li>
<li>
<span style="text-align: center;">The values to push if the item is new (optional)</span><br>
</li>
</ul></div></section><section data-id="7cb38a11dfbc3608b310c0b16619de8f"><h2>Atomic Updates</h2>
<div style="text-align: left; ">We have a collection that is storing the view counts for each product in our system. When a user views the page, we want to increment a counter and also set the last view time. Optionally we want to add a keyword that was used when the user searched.</div>
<div style="text-align: left; "><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:blue;">var</span> <span style="color:gray;">asinName</span> <span style="color:red;">=</span> <span style="color:#a31515;">"B00000J1TX"</span>;
<span style="color:blue;">var</span> <span style="color:gray;">query</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Query</span><span style="color:red;">.</span><span style="color:gray;">And</span>(<span style="color:#2b91af;">Query</span><span style="color:red;">.</span><span style="color:gray;">EQ</span>(<span style="color:#a31515;">"_id"</span>, <span style="color:gray;">asinName</span>));
<span style="color:blue;">var</span> <span style="color:gray;">sortBy</span> <span style="color:red;">=</span> <span style="color:#2b91af;">SortBy</span><span style="color:red;">.</span><span style="color:gray;">Null</span>;
<span style="color:blue;">var</span> <span style="color:gray;">update</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Update</span><span style="color:red;">.</span><span style="color:gray;">Inc</span>(<span style="color:#a31515;">"counter"</span>, <span style="color:maroon;">1</span>)<span style="color:red;">.</span><span style="color:gray;">Set</span>(<span style="color:#a31515;">"lastView"</span>, DateTime<span style="color:red;">.</span><span style="color:gray;">Now</span>)
    <span style="color:red;">.</span><span style="color:gray;">SetOnInsert</span>(<span style="color:#a31515;">"keywords"</span>, <span style="color:blue;">new</span> <span style="color:#2b91af;">BsonArray</span>(<span style="color:blue;">new</span>[] { <span style="color:#a31515;">"new"</span> }));
<span style="color:blue;">var</span> <span style="color:gray;">result</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductViewCollection</span>
    <span style="color:red;">.</span><span style="color:gray;">FindAndModify</span>(<span style="color:gray;">query</span>, <span style="color:gray;">sortBy</span>, <span style="color:gray;">update</span>, <span style="color:blue;">true</span>, <span style="color:blue;">true</span>);
 
<span style="color:blue;">var</span> <span style="color:gray;">found</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductViewCollection</span><span style="color:red;">.</span><span style="color:gray;">FindOne</span>(<span style="color:gray;">query</span>);</pre></div></section><section data-id="1677550b402bd3a9b85f988c6409d934"><h2>Atomic Updates</h2>
<div><ul>
<li>
<span style="text-align: center;">findAndModify will only update one record, no matter how you use it.</span><br>
</li>
<li>
<span style="text-align: center;">If multiple documents need to be updated, you must use the Update method.</span><br>
</li>
<li><span style="text-align: center;">Each document update will be atomic but the update as a whole will not</span></li>
<li><span style="text-align: center;">If there is a failure while performing your update, there is no way to know which documents were updated and which ones were not.</span></li>
</ul></div></section><section data-id="3591306f2708f4dadc5033109d84cbf8"><h2>Atomic Updates<br>
</h2>
<div>Update all documents in the collection</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:blue;">var</span> <span style="color:gray;">update</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Update</span><span style="color:red;">.</span><span style="color:gray;">Inc</span>(<span style="color:#a31515;">"counter"</span>, <span style="color:maroon;">1</span>);
<span style="color:blue;">var</span> <span style="color:gray;">result</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductViewCollection</span>
    <span style="color:red;">.</span><span style="color:gray;">Update</span>(<span style="color:blue;">null</span>, <span style="color:gray;">update</span>); </pre></div></section><section data-id="0edc35bbfb0d440ed70c26da6c1685aa"><h2>Atomic Updates</h2>
    <div>Updating all documents that contain a keyword and only add a new keyword if it does not already exist.</div>
    <div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:blue;">var</span> <span style="color:gray;">array</span> <span style="color:red;">=</span> <span style="color:blue;">new</span> <span style="color:#2b91af;">List</span><span style="color:red;">&lt;</span><span style="color:blue;">string</span><span style="color:red;">&gt;</span>() { <span style="color:#a31515;">"new"</span> };
<span style="color:blue;">var</span> <span style="color:gray;">query</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Query</span><span style="color:red;">&lt;</span><span style="color:#2b91af;">MongoProductView</span><span style="color:red;">&gt;.</span><span style="color:gray;">All</span>(<span style="color:gray;">item</span> <span style="color:red;">=&gt;</span> <span style="color:gray;">item</span><span style="color:red;">.</span><span style="color:gray;">Keywords</span>, <span style="color:gray;">array</span>);
<span style="color:green;">//show that we did return a product.</span>
<span style="color:blue;">var</span> <span style="color:gray;">found</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductViewCollection</span><span style="color:red;">.</span><span style="color:gray;">Find</span>(<span style="color:gray;">query</span>)<span style="color:red;">.</span><span style="color:gray;">ToList</span>();
<span style="color:green;">//Add keyword to all documents that have a keyword of new</span>
<span style="color:blue;">var</span> <span style="color:gray;">update</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Update</span><span style="color:red;">.</span><span style="color:gray;">AddToSet</span>(<span style="color:#a31515;">"keywords"</span>, <span style="color:#a31515;">"test"</span>);
<span style="color:green;">//you could also use push if you wanted it added no matter what.</span>
<span style="color:green;">//var update = Update.Push("keywords", "test");</span>
<span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductViewCollection</span><span style="color:red;">.</span><span style="color:gray;">Update</span>(<span style="color:gray;">query</span>, <span style="color:gray;">update</span>);
 
</pre></div>
</section></section><section data-id="3a619fe06d8366c8773d8687e937e1f3"><h2>What an e-commerce database would look like in SQL Server</h2>
<div>
<img src="../images/lightspeed_schema.png" style="width: 732px; height: 525.687898089172px; max-height: none; max-width: none;"><br>
</div>
    </section><section data-id="c540a99bd7439288a94c2b50a1252fd3"><section data-id="8b468a3f02c0700a56547f58782a9d85"><h2>What an e-commerce database would look like in MongoDB</h2>
<div><ul>
<li>
<span style="text-align: center;">Foreign Keys do not exist in MongoDB</span><br>
</li>
<li>
<span style="text-align: center;">You may use References or store the data in the document</span><br>
</li>
<li><span style="text-align: center;">Depending on how often you need to display or work with those values will dictate if you have denormalized data</span></li>
</ul></div>
    </section><section data-id="8182c73512f0c3ea84848019edbe6ecf"><h2>MongoDB Model</h2>
<div>
<img src="../images/mongodb_schema.png"><br>
</div></section></section><section data-id="85feab1fa4ee08a421aee069600159e5"><section data-id="87fa6368333e270b6d3b0effe56f13e5"><h2>Adding a new column</h2>
<div><br></div>
<div>
<div>ALTER TABLE ProductView</div>
<div>ADD extra nvarchar(10)</div>
</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:blue;">var</span> <span style="color:gray;">update</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Update</span><span style="color:red;">.</span><span style="color:gray;">Set</span>(<span style="color:#a31515;">"extra"</span>, <span style="color:#a31515;">""</span>);
<span style="color:blue;">var</span> <span style="color:gray;">result</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductViewCollection</span>
    <span style="color:red;">.</span><span style="color:gray;">Update</span>(<span style="color:blue;">null</span>, <span style="color:gray;">update</span>);
</pre></div></section><section data-id="a9edec147c39dc4771414f5595b9d513"><h2>Removing a column</h2>
<div><br></div>
<div>
<div>ALTER TABLE ProductView</div>
<div>DROP COLUMN extra</div>
</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:blue;">var</span> <span style="color:gray;">update</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Update</span><span style="color:red;">.</span><span style="color:gray;">Unset</span>(<span style="color:#a31515;">"extra"</span>);
<span style="color:blue;">var</span> <span style="color:gray;">result</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductViewCollection</span>
    <span style="color:red;">.</span><span style="color:gray;">Update</span>(<span style="color:blue;">null</span>, <span style="color:gray;">update</span>);
</pre></div></section><section data-id="2a5da01c54eb2a8b938f6be09471ccd2"><h2>Creating an index</h2>
<div><br></div>
<div>
<div>CREATE INDEX idx_counter</div>
<div>ON ProductView(counter)</div>
</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductViewCollection</span><span style="color:red;">.</span><span style="color:gray;">EnsureIndex</span>(<span style="color:#2b91af;">IndexKeys</span><span style="color:red;">&lt;</span><span style="color:#2b91af;">MongoProductView</span><span style="color:red;">&gt;</span>
    <span style="color:red;">.</span><span style="color:gray;">Ascending</span>(<span style="color:gray;">item</span> <span style="color:red;">=&gt;</span> <span style="color:gray;">item</span><span style="color:red;">.</span><span style="color:gray;">Counter</span>), <span style="color:#2b91af;">IndexOptions</span><span style="color:red;">.</span><span style="color:gray;">SetBackground</span>(<span style="color:blue;">true</span>));
</pre></div></section><section data-id="5e77f82e5db4802d893591469d70be62"><h2>Drop Table</h2>
<div><br></div>
<div>DROP TABLE ProductView<br>
</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductViewCollection</span><span style="color:red;">.</span><span style="color:gray;">Drop</span>();
</pre></div></section><section data-id="08b239c347c6689666df55fefbcc620e"><h2>Select all records from collection</h2>
<div><br></div>
<div>Select * from ProductView</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductCollection</span><span style="color:red;">.</span><span style="color:gray;">FindAll</span>();
</pre></div></section><section data-id="b59481ff0ccd73fbfa0be059125e2d0c"><h2>select records with an order by</h2>
<div><br></div>
<div>Select * from Product where asin = '123'</div>
<div>order by Title</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductCollection</span><span style="color:red;">.</span><span style="color:gray;">Find</span>(<span style="color:gray;">query</span>)
    <span style="color:red;">.</span><span style="color:gray;">SetSortOrder</span>(<span style="color:#2b91af;">SortBy</span><span style="color:red;">&lt;</span><span style="color:#2b91af;">MongoProduct</span><span style="color:red;">&gt;.</span><span style="color:gray;">Ascending</span>(<span style="color:gray;">item</span> <span style="color:red;">=&gt;</span> <span style="color:gray;">item</span><span style="color:red;">.</span><span style="color:gray;">Title</span>));
</pre></div></section><section data-id="654bde14fd547817361fcbb7dcad8b41"><h2>Get the count of rows</h2>
<div><br></div>
<div>Select count(*) from Product where ListPrice &lt; 4.99</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:blue;">var</span> <span style="color:gray;">query</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Query</span><span style="color:red;">&lt;</span><span style="color:#2b91af;">MongoProduct</span><span style="color:red;">&gt;.</span><span style="color:gray;">Where</span>(<span style="color:gray;">item</span> <span style="color:red;">=&gt;</span> <span style="color:gray;">item</span><span style="color:red;">.</span><span style="color:gray;">ListPrice</span> <span style="color:red;">&lt;</span> <span style="color:maroon;">4.99m</span>);
<span style="color:blue;">var</span> <span style="color:gray;">count</span> <span style="color:red;">=</span> <span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductCollection</span><span style="color:red;">.</span><span style="color:gray;">Count</span>(<span style="color:gray;">query</span>);
</pre></div></section><section data-id="aa3ed677bbaf5e0c59e6b6584063f4be"><h2>Get the Distinct values of a column</h2>
<div><br></div>
<div>Select Distinct(Title) from Product</div>
<div><br></div>
<div><pre style="font-family:Consolas;font-size:14;color:black;background:white;"><span style="color:#2b91af;">Collections</span><span style="color:red;">.</span><span style="color:gray;">ProductCollection</span><span style="color:red;">.</span><span style="color:gray;">Distinct</span>(<span style="color:#a31515;">"Title"</span>, <span style="color:gray;">query</span>);
</pre></div></section></section><section data-id="b072e93b8693f9217f4c160fdf23a392"><section data-id="6d1b89721d2e2d66700e995b45f13e26"><h2>MAp Reduce</h2>
<div>
<ul>
<li>
<span style="text-align: center;">MongoDB has built in functionality to perform Map Reduce</span><br>
</li>
<li>
<span style="text-align: center;">It is much easier to get up and running than Hadoop</span><br>
</li>
<li>
<span style="text-align: center;">Can be used as a connector for Hadoop</span><br>
</li>
</ul>
<div><br></div>
</div>
<div style="text-align: left; ">http://docs.mongodb.org/ecosystem/tutorial/getting-started-with-hadoop/<br>
</div>
<div style="text-align: left; ">http://docs.mongodb.org/ecosystem/use-cases/hadoop/<br>
</div></section><section data-id="7eae334897a434817d1c03093bd2b1f8"><h2>Aggregation Framework</h2>
<div>This is an alternative to using Map Reduce</div>
<div>Results must be less than 16mb (document max)</div></section></section><section data-id="4b751dfdace7827e4cafaf80efd8ff6a"><section data-id="25a4193b54ad23e25ca4299c11cddd4a"><h2>Challenges of migrating to MongoDB for a SQL Server user</h2>
<div><ul>
<li>
<span style="text-align: center;">"Like" Statements are very slow</span><br>
</li>
<li>
<span style="text-align: center;">Full Text search can only exist for one field per collection</span><br>
</li>
<li><span style="text-align: center;">If a value changes on a denormalized field, you must perform an update statement to keep the values in sync</span></li>
<li><span style="text-align: center;">Update statements are not intuitive</span></li>
<li><span style="text-align: center;">No transactions across multiple rows (documents)</span></li>
<li><span style="text-align: center;">Two phase commits difficult to understand and keeping state for a rollback is even more difficult</span></li>
</ul></div></section><section data-id="fbc8db2813a736bb3f1b2494e7941bb2"><h2>Search can be solved</h2>
<div>
<ul>
<li>
<span style="text-align: center;">ElasticSearch is an option and is free</span><br>
</li>
<li>
<span style="text-align: center;">Requires MongoDB be set up as a Replica Set</span><br>
</li>
</ul>
<div><br></div>
</div>
<div style="text-align: left; ">http://docs.mongodb.org/manual/tutorial/convert-standalone-to-replica-set/<br>
</div>
<div style="text-align: left; ">http://www.elasticsearch.org/<br>
</div></section><section data-id="a364bea7c98527896ae295843a31fc36"><h2>Two Phase commits</h2>
<div>
<ul>
<li>
<span style="text-align: center;">It is possible and allows for massive scale out but you need a coordinator</span><br>
</li>
<li><span style="text-align: center;">Additional reading can be found at</span></li>
</ul>
<div style="text-align: left; "><span style="font-size: 36px; font-style: normal; font-variant: normal; text-align: center;"><br></span></div>
<div style="text-align: left; ">
<span style="font-size: 36px; font-style: normal; font-variant: normal; text-align: center;">http://docs.mongodb.org/manual/tutorial/perform-two-phase-commits/</span><br>
</div>
</div></section><section data-id="ff1b6839a35256dc08ead79574fea0b1"><h2>Information about Text indexes</h2>
<div><br></div>
<div style="text-align: left; ">http://docs.mongodb.org/v2.4/reference/command/text/<br>
</div>
<div style="text-align: left; ">http://docs.mongodb.org/v2.4/core/index-text/#index-feature-text<br>
</div></section></section><section data-id="675fc56a0e0ede751554b044ddb6e65d"><h2>More information</h2>
<div><ul>
<li style="text-align: left;">
<span style="text-align: center;">Mongodb open data day 2014: </span>http://www.slideshare.net/davidjeet/mongodb-open-data-day-2014</li>
<li style="text-align: left;">
<span style="text-align: center;">Manual: http://docs.mongodb.org/manual/</span><br>
</li>
<li style="text-align: left;">
<span style="text-align: center;">Using the driver: </span>http://docs.mongodb.org/ecosystem/tutorial/use-csharp-driver/</li>
<li style="text-align: left;">Serialization: http://docs.mongodb.org/ecosystem/tutorial/serialize-documents-with-the-csharp-driver/</li>
</ul></div></section>
			</div>
<!-- \\ Any section element inside of this container is displayed as a slide -->

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
